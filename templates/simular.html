{% extends "base.html" %}

{% block title %}Simular Riego - Sistema de Riego{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2 class="mb-4">
            <i class="fas fa-play me-2"></i>
            Simular Proceso de Riego
        </h2>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-cogs me-2"></i>
                    Configuración de Simulación
                </h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label for="invernadero" class="form-label">
                            <i class="fas fa-warehouse me-1"></i>
                            Seleccionar Invernadero
                        </label>
                        <select class="form-select" id="invernadero" name="invernadero" required onchange="this.form.submit()">
                            <option value="">Seleccione un invernadero</option>
                            {% for invernadero in invernaderos.iterar() %}
                            <option value="{{ invernadero.nombre }}" {% if invernadero_seleccionado == invernadero.nombre %}selected{% endif %}>
                                {{ invernadero.nombre }} ({{ invernadero.numero_hileras }}H x {{ invernadero.plantas_por_hilera }}P)
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label for="plan" class="form-label">
                            <i class="fas fa-calendar-alt me-1"></i>
                            Seleccionar Plan de Riego
                        </label>
                        <select class="form-select" id="plan" name="plan" required {% if not planes_disponibles %}disabled{% endif %}>
                            <option value="">Seleccione un plan</option>
                            {% if planes_disponibles %}
                                {% for plan in planes_disponibles.iterar() %}
                                <option value="{{ plan.nombre }}">{{ plan.nombre }} - {{ plan.secuencia }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                        <div class="form-text">
                            {% if not invernadero_seleccionado %}
                                Primero seleccione un invernadero para cargar los planes disponibles
                            {% elif not planes_disponibles %}
                                No hay planes disponibles para este invernadero
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('index') }}" class="btn btn-secondary me-md-2">
                            <i class="fas fa-arrow-left me-1"></i>Volver
                        </a>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-play me-1"></i>Ejecutar Simulación
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>
                    Información sobre la Simulación
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-clock me-1"></i> Reglas de Tiempo:</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-arrow-right text-primary me-1"></i> 1 segundo por movimiento</li>
                            <li><i class="fas fa-tint text-info me-1"></i> 1 segundo por riego</li>
                            <li><i class="fas fa-pause text-warning me-1"></i> Solo 1 dron riega a la vez</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-chart-bar me-1"></i> Resultados:</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-stopwatch text-success me-1"></i> Tiempo óptimo</li>
                            <li><i class="fas fa-tint text-primary me-1"></i> Agua por dron</li>
                            <li><i class="fas fa-seedling text-info me-1"></i> Fertilizante por dron</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
